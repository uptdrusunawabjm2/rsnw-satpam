<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Daftar Penghuni</title>

<style>
:root{
--bg:#0f172a;--accent:#e2e8f0;
}
body{margin:0;background:var(--bg);font-family:system-ui,Segoe UI,Arial;color:var(--accent)}
.wrap{max-width:900px;margin:auto;padding:16px}

.title{font-size:20px;font-weight:700;margin-bottom:12px;text-align:center}

.controls{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px}
input,select,button{
padding:10px;border-radius:10px;border:1px solid #334155;
background:#0f172a;color:#e2e8f0
}
button{cursor:pointer}

table{width:100%;border-collapse:collapse}
thead th{background:#1e293b;padding:10px;text-align:left}
td{padding:10px;border-bottom:1px solid #334155}
tbody tr:hover{background:rgba(255,255,255,0.03)}

td:first-child{
font-family:monospace;
font-weight:600;
text-transform:uppercase;
letter-spacing:.6px;
}

/* MOBILE */
@media (max-width:720px){
.controls{flex-direction:column}
input,select,button{width:100%}
}

/* ===== SAMAKAN SEARCH & SELECT ===== */

.controls{
display:flex;
flex-direction:column;
gap:10px;
}

.controls input,
.controls select,
.controls button{
width:100%;
box-sizing:border-box;
height:44px;
padding:10px 12px;
border-radius:12px;
border:1px solid #334155;
background:#0f172a;
color:#e2e8f0;
font-size:14px;
display:block;
}

/* Fokus modern */
.controls input:focus,
.controls select:focus{
border-color:#3b82f6;
box-shadow:0 0 0 1px #3b82f6;
}

/* Reset button center */
#resetBtn{
font-weight:600;
letter-spacing:.3px;
}

/* ===== MOBILE MODERN UI ===== */

@media (max-width:720px){

.wrap{
padding:12px;
}

.title{
font-size:18px;
text-align:center;
margin-bottom:14px;
}

/* Kontrol lebih nyaman disentuh */
.controls input,
.controls select,
.controls button{
height:48px;
font-size:15px;
border-radius:14px;
}

/* Efek tekan */
.controls button:active{
transform:scale(.98);
}

/* List lebih lega */
td{
padding:14px 10px;
font-size:14px;
}

/* Unit lebih jelas */
td:first-child{
font-size:13px;
letter-spacing:.6px;
}

/* Nama lebih fokus */
td:nth-child(2){
font-weight:500;
}

/* Scroll halus */
.table-wrap{
overflow-x:auto;
scroll-behavior:smooth;
}

/* Card-like row */
tbody tr{
border-radius:10px;
}

tbody tr:hover{
background:rgba(255,255,255,0.04);
}

}
  
</style>
</head>

<body>
<div class="wrap">

<div class="title">Daftar Penghuni untuk Tenaga Keamanan</div>

<div class="controls">
<input id="search" placeholder="Cari unit / nama"/>

<select id="lokasi">
<option value="">Semua Lokasi</option>
<option value="GM-">Ganda Maghfirah</option>
<option value="TK-">Teluk Kelayan</option>
</select>

<button id="resetBtn">Reset</button>
</div>

<div class="table-wrap" style="max-height:70vh;overflow:auto">
<table>
<thead>
<tr>
<th>Unit</th>
<th>Nama</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

</div>

<script>
const GAS_URL="https://script.google.com/macros/s/AKfycbzjABRVgRaoMj3Y1gCU_DRJpnZIvkGwxRRxmPW6buV1POsQ87GQCLAeEBG5j9jJZux7iQ/exec";
const CACHE_KEY="RUSUN_CACHE_V3_SIMPLE";

let RAW=[],VIEW=[];

async function load(){
try{
const cache=sessionStorage.getItem(CACHE_KEY);
if(cache){RAW=JSON.parse(cache);VIEW=RAW;render();}

const res=await fetch(GAS_URL+"?action=internal&key=rusun2026");
const json=await res.json();
if(!json.status)return;

const rows=json?.data?.data||[];

RAW=rows.map(r=>({
Unit:String(r.unit||r["No. Unit"]||r.Unit||"").trim(),
Nama:String(r.nama||r["Nama Penghuni"]||r.Nama||"").trim()
}));

RAW.sort((a,b)=>a.Unit.localeCompare(b.Unit,undefined,{numeric:true}));

sessionStorage.setItem(CACHE_KEY,JSON.stringify(RAW));
VIEW=RAW;
render();
}catch(e){console.error(e);}
}

function render(){
let html="";
for(const d of VIEW){
html+=`<tr>
<td>${d.Unit.toUpperCase()}</td>
<td>${d.Nama}</td>
</tr>`;
}
document.getElementById("tbody").innerHTML=html;
}

function applyFilter(){
const s=document.getElementById("search").value.toLowerCase();
const l=document.getElementById("lokasi").value;

VIEW=RAW.filter(d=>{
if(l&&!d.Unit.toUpperCase().startsWith(l))return false;
if(!s)return true;
return d.Unit.toLowerCase().includes(s)||d.Nama.toLowerCase().includes(s);
});
render();
}

document.getElementById("search").oninput=applyFilter;
document.getElementById("lokasi").onchange=applyFilter;

document.getElementById("resetBtn").onclick=()=>{
document.getElementById("search").value="";
document.getElementById("lokasi").value="";
VIEW=RAW;
render();
};

load();
</script>
</body>
</html>
